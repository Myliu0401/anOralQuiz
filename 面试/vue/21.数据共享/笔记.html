<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        /* 
               在 vue中 遇到需要 共享的数据，会有几个问题：
                  1.如何保证数据的唯一性？
                        如果数据不唯一，则会浪费大量的内存资源，降低运行效率。
                           如：A组件 和 B组件 是兄弟组件，且用到一个数据必须是相同的，其中一个组件该变数据另一个组件数据也会改变，如果
                               每个组件都声明数据，则会浪费内存。
                        
                        如果数据不唯一，则可能出现不统一的数据，难以维护。
                           如：A组件某个数据更改 B组件的某个数据也必须跟着更改。

                    
                   2.某个组件改动数据后，如何让其他用到该数据的组件知道数据变化？（也就是数据响应）
                        事件总线貌似可以解决该问题，但需要在组件中手动的维护监听，极其不便，而且事件总线的目的在于 通知
                        而不在于 数据共享。


                 解决上述的数据共享，可以用 把需要共享的数据 全部提到跟组件，然后一层层往下发，需要更改数据时，就一层层往上提交到跟组件
                     进行更改。
                    但是这种方法过于恶心，需要编写大量的代码层层往下发数据，很多组件被迫拥有自己不需要的数据。
                                        还需要编写大量的代码层层往上递交，迫使很多组件拥有自己处理的事件。
                 

                 解决上面问题，可以设置一个独立的数据仓库。
                     组件需要上面数据，就从独立的数据仓库中拿。
                     组件有权更改数据仓库中的数据，且更改后，其他用到该数据仓库的对应数据，也会跟着改变。
      

                VUEX就是一个独立的数据仓库。

                   下载vuex
                   npm install vuex

                   向Vue中注入 vuex 插件
                   Vue.use(vuex)   

                   创建仓库
                   cosnt store = new vuex.Store(配置对象);
                   创建好仓库后，可以从 store.state 来访问仓库中的数据

                   向vue注入创库
                   new Vue({
                     store, // 向vue中注入仓库
                     render: h => h(App)
                   }).$mount("#app");

                   向vue注册仓库后，vue会向每个实例中加入仓库 为 $store 属性。

                   Vuex会自动将配置的状态数据设置为响应式数据，当数据变化时，依赖该数据的组件会自动重新渲染。


                数据的变更
                   可以利用数据响应的特点，直接变更数据，但这样会有一些问题：
                       直接变更数据 vuex 无法记录数据变更的状态，会使得复杂的数据结构或复杂的组件结构，vuex调试起来困难。

                    为了更好的跟踪和记录数据的变化，使用 mutation 来更改数据 ，mutation意思为突变。
                       mutation为对象，是vuex配置对象中的一员。 吐音：米特顺
                          每个突变为一个函数，它描述了数据在某种场景下的变化。
                          并且会传入一个参数，第一个参数为 state 为当前的仓库数据
                          突变函数xxx 表示mutation描述了数据在做什么应该发生什么变化
                          仓库中只数据只能在突变中更改

                          但是突变函数中不能有异步操作或者任何副作用的操作(更改或读取外部环境的信息，例如localStorage、location、DOM等)
                          因为如果使用异步vuex没法跟踪和记录数据变化，执行完突变函数后,vuex就直接记录数据了。
                        
                    提交突变  ---- 提交mutation是数据改变的唯一原因
                       vue实例.$store.commit('突变函数名',负荷也就是数据); 会返回突变函数的返回值
                       vuex就会执行数据仓库中mutation对象里相应的突变函数。

                  
                 异步更改数据 --- actions   吐音：哎克顺
                    actiosn为对象，也是vuex配置对象中的成员
                    actions对象里的成员为函数，在这写自定义成员中执行异步操作。
                     如：actions:{
                          //ctx参数为 vuex自己传进来的类似于store仓库，也就是数据仓库。 payload参数为自己传的数据
                          xxxx(ctx, payload){
                               setTimeout(function(){
                                  ctx.commit("power", payload); //进行突变提交
                                }, 1000)
                          }
                     }

                     提交异步突变
                     vue实例.$store.dispatch('actions里的函数',数据);    吐音：地是葩取
                     提交异步突变后，vuex就会执行actions对象里相应的函数。
                     异步突变函数里更改数据也必须使用 突变函数来更改数据，因为提交突变是数据改变的唯一原因
 
                             

                
        
         */
    </script>
</body>
</html>