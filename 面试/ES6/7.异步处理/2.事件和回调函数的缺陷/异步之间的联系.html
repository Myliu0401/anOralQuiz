<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <script>
        /* 
                小明心中有二十个女神,他决定用更加高效的办法
                他同时给二十个女神表白,如果有女神同意,就拒绝其他女神,并且
                当所有的女神回复完成后,他要把所有的回复都记录到日记进行分析
                用带码模拟上面的场景
           
          
          
          
          */


        function biaobai(nvhsneg, func) {
            console.log(`向女神${nvhsneg}表白`)

            //开启异步线程,'表示女神的思考'
            setTimeout(() => {
                if (Math.random() < 0.1) {
                    func(nvhsneg, true)
                } else {
                    func(nvhsneg, false)
                }
            }, Math.floor(Math.random() * (3000 - 1000) + 1000))
        }

        let cont = null; //用装第一个表白成功的
        const arr = [];
        for (let i = 1; i <= 20; i++) {
            biaobai(i, function (nvhsneg, boolean) {
                arr.push(`女神${nvhsneg}` + boolean)
                if (boolean) {
                    console.log(`女神${nvhsneg}同意了`)
                    if (cont) {
                        console.log('老子已经有了' + `女神${nvhsneg+'请滚'}`)

                    } else {
                        cont = '女神' + nvhsneg;
                        console.log('小明厉害！！！')
                    }
                } else {
                    console.log(`女神${nvhsneg}拒绝`)
                }


                //每个异步执行,都要判断一次,不合理
                if (arr.length === 20) { 
                    console.log('OK', arr)
                }
            })
        }
    </script>
</body>

</html>